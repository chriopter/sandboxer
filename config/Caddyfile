# Sandboxer reverse proxy
# Expose :8080 publicly, proxy to internal services

:8080 {
    # ttyd terminal sessions (ports 7700-7799)
    # flush_interval -1 disables buffering for real-time terminal I/O
    @ttyd path_regexp ttyd ^/t/(77[0-9]{2})/(.*)$
    handle @ttyd {
        uri strip_prefix /t/{re.ttyd.1}
        reverse_proxy 127.0.0.1:{re.ttyd.1} {
            flush_interval -1
        }
    }

    # Python backend
    reverse_proxy 127.0.0.1:8081
}
