<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Sandboxer</title>
  <link rel="icon" type="image/png" href="/static/favicon.png">
  <link rel="apple-touch-icon" href="/static/favicon.png">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="/static/webtui.css">
  <link rel="stylesheet" href="/static/catppuccin.css">
  <link rel="stylesheet" href="/static/style.css">
</head>
<body data-webtui-theme="catppuccin-mocha">

<header class="mobile-header">
  <button class="mobile-menu-btn" onclick="toggleSidebar()">☰</button>
  <span class="mobile-title">sandboxer</span>
  <button class="mobile-add-btn" onclick="createSession('claude')">+</button>
</header>

<div class="sidebar-overlay" id="sidebarOverlay" onclick="toggleSidebar()"></div>
<aside class="sidebar" id="sidebar">
  <div class="sidebar-row">
    <button variant-="green" size-="small" class="sidebar-toggle" onclick="toggleSidebar()" title="Toggle sidebar">≡</button>
    <select-dropdown id="dirSelect" data-value="{{selected_folder}}">
      <details is-="popover" position-="bottom">
        <summary tabindex="0" is-="button" size-="small">{{selected_folder_name}}</summary>
        <column id="dirOptions">
          {{dir_options}}
        </column>
      </details>
    </select-dropdown>
  </div>
  <div class="sidebar-row">
    <select-dropdown id="typeSelect" data-value="claude">
      <details is-="popover" position-="bottom">
        <summary tabindex="0" is-="button" size-="small">claude</summary>
        <column id="typeOptions">
          <button data-value="claude" size-="small" aria-selected="true">claude</button>
          <button data-value="chat" size-="small" aria-selected="false">chat</button>
          <button data-value="gemini" size-="small" aria-selected="false">gemini</button>
          <button data-value="resume" size-="small" aria-selected="false">resume</button>
          <button data-value="lazygit" size-="small" aria-selected="false">lazygit</button>
          <button data-value="bash" size-="small" aria-selected="false">bash</button>
        </column>
      </details>
    </select-dropdown>
    <span id="resumeWrap" class="resume-wrap">
      <select-dropdown id="resumeSelect" data-value="">
        <details is-="popover" position-="bottom">
          <summary tabindex="0" is-="button" size-="small">...</summary>
          <column id="resumeOptions">
          </column>
        </details>
      </select-dropdown>
    </span>
    <button variant-="green" size-="small" onclick="createSession()" class="new-btn">+</button>
  </div>
  <button variant-="green" size-="small" class="sidebar-new-collapsed" onclick="createSession()" title="New session">+</button>
  <ul class="sidebar-list" id="sidebarList">
  </ul>
  <div class="sidebar-bottom">
    <div class="sidebar-actions">
      <button class="tui-action" onclick="copyTakeover()" title="SSH to current folder"><span class="hotkey">s</span>ssh</button>
      <button class="tui-action" onclick="restartSandboxer()" title="Restart sandboxer service"><span class="hotkey">r</span>restart</button>
      <button class="tui-action" onclick="closeAllSessions()" title="Close all visible sessions"><span class="hotkey">x</span>close all</button>
    </div>
    <div class="sidebar-controls">
      <div class="control-row">
        <span class="control-label">view</span>
        <div class="view-modes" id="viewModes">
          <button data-view="1" title="1 column">1</button>
          <button data-view="2" title="2 columns">2</button>
          <button data-view="3" title="3 columns">3</button>
        </div>
      </div>
      <div class="control-row">
        <span class="control-label">zoom</span>
        <div class="zoom-modes" id="zoomModes">
          <button data-zoom="50" title="Small (50%)">S</button>
          <button data-zoom="75" title="Medium (75%)">M</button>
          <button data-zoom="100" title="Large (100%)">L</button>
        </div>
      </div>
    </div>
    <div class="sidebar-stats">
      <div class="stat" id="cpuStat"><span>--</span><label>cpu</label></div>
      <div class="stat" id="memStat"><span>--</span><label>mem</label></div>
      <div class="stat" id="diskStat"><span>--</span><label>disk</label></div>
    </div>
  </div>
</aside>

<main>
  <div class="grid">
    {{cards}}
  </div>
</main>

<div id="modal" class="modal" onclick="if(event.target===this) hideModal()">
  <div class="modal-box">
    <button class="modal-close" variant-="red" size-="small" onclick="hideModal()">×</button>
    <h2>claude command</h2>
    <pre>IS_SANDBOX=1 claude --dangerously-skip-permissions \
  --system-prompt {{system_prompt_path}}</pre>
    <p>--dangerously-skip-permissions skips all permission prompts</p>
    <p>--system-prompt loads custom sandbox behavior</p>
    <p>sessions run in tmux and persist across restarts</p>
  </div>
</div>

<script src="/static/main.js"></script>
</body>
</html>
