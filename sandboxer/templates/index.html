<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Sandboxer</title>
  <link rel="icon" type="image/png" href="/static/favicon.png">
  <link rel="apple-touch-icon" href="/static/favicon.png">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="/static/webtui.css">
  <link rel="stylesheet" href="/static/catppuccin.css">
  <link rel="stylesheet" href="/static/style.css">
</head>
<body data-webtui-theme="catppuccin-mocha">

<header class="mobile-header">
  <button class="mobile-menu-btn" onclick="toggleSidebar()">☰</button>
  <span class="mobile-title">sandboxer</span>
  <button class="mobile-add-btn" onclick="createSession('claude')">+</button>
</header>

<div class="sidebar-overlay" id="sidebarOverlay" onclick="toggleSidebar()"></div>
<aside class="sidebar" id="sidebar">
  <div class="sidebar-row">
    <button size-="small" class="sidebar-toggle" onclick="toggleSidebar()" title="Toggle sidebar">≡</button>
    <select-dropdown id="dirSelect" data-value="{{selected_folder}}">
      <details is-="popover" position-="bottom">
        <summary tabindex="0" is-="button" size-="small">{{selected_folder_name}} <span class="dropdown-indicator">˅</span></summary>
        <column id="dirOptions">
          {{dir_options}}
        </column>
      </details>
    </select-dropdown>
  </div>
  <button variant-="green" size-="small" class="sidebar-new-collapsed" onclick="createSession()" title="New session">+</button>
  <div class="sidebar-new-row">
    <select-dropdown id="typeSelect" data-value="claude">
      <details is-="popover" position-="bottom">
        <summary tabindex="0" is-="button" size-="small">claude <span class="dropdown-indicator">˅</span></summary>
        <column id="typeOptions" class="dropdown-left">
          <button data-value="claude" size-="small" aria-selected="true">claude</button>
          <button data-value="chat" size-="small" aria-selected="false">claude chat</button>
          <button data-value="loop" size-="small" aria-selected="false">claude loop</button>
          <button data-value="resume" size-="small" aria-selected="false">claude resume</button>
          <button data-value="lazygit" size-="small" aria-selected="false">lazygit</button>
          <button data-value="bash" size-="small" aria-selected="false">bash</button>
          <button data-value="gemini" size-="small" aria-selected="false">gemini</button>
        </column>
      </details>
    </select-dropdown>
    <span id="resumeWrap" class="resume-wrap">
      <select-dropdown id="resumeSelect" data-value="">
        <details is-="popover" position-="bottom">
          <summary tabindex="0" is-="button" size-="small">... <span class="dropdown-indicator">˅</span></summary>
          <column id="resumeOptions">
          </column>
        </details>
      </select-dropdown>
    </span>
    <button variant-="green" size-="small" onclick="createSession()" class="new-btn">+ new</button>
  </div>
  <ul class="sidebar-list" id="sidebarList">
  </ul>
  <div class="sidebar-bottom">
    <div class="sidebar-controls">
      <select-dropdown id="viewSelect" data-value="2">
        <details is-="popover" position-="top">
          <summary tabindex="0" is-="button" size-="small">2 col <span class="dropdown-indicator">˅</span></summary>
          <column id="viewOptions">
            <button data-value="1" size-="small" aria-selected="false">1 col</button>
            <button data-value="2" size-="small" aria-selected="true">2 col</button>
            <button data-value="3" size-="small" aria-selected="false">3 col</button>
          </column>
        </details>
      </select-dropdown>
      <select-dropdown id="zoomSelect" data-value="100">
        <details is-="popover" position-="top">
          <summary tabindex="0" is-="button" size-="small">100% <span class="dropdown-indicator">˅</span></summary>
          <column id="zoomOptions">
            <button data-value="50" size-="small" aria-selected="false">50%</button>
            <button data-value="75" size-="small" aria-selected="false">75%</button>
            <button data-value="100" size-="small" aria-selected="true">100%</button>
            <button data-value="125" size-="small" aria-selected="false">125%</button>
            <button data-value="150" size-="small" aria-selected="false">150%</button>
          </column>
        </details>
      </select-dropdown>
    </div>
    <div class="sidebar-stats">
      <div class="stat" id="cpuStat">
        <div class="progress-bar"><div class="progress-fill"></div><span class="progress-text">cpu 0%</span></div>
      </div>
      <div class="stat" id="memStat">
        <div class="progress-bar"><div class="progress-fill"></div><span class="progress-text">mem 0%</span></div>
      </div>
    </div>
    <div class="sidebar-actions">
      <button variant-="teal" size-="small" onclick="copyTakeover()" title="SSH to current folder">ssh</button>
      <button variant-="mauve" size-="small" onclick="restartSandboxer()" title="Restart sandboxer service">restart</button>
      <button variant-="red" size-="small" onclick="closeAllSessions()" title="Close all visible sessions">kill</button>
    </div>
  </div>
</aside>

<main>
  <div class="grid">
    {{cards}}
  </div>
</main>

<div id="modal" class="modal" onclick="if(event.target===this) hideModal()">
  <div class="modal-box">
    <button class="modal-close" variant-="red" size-="small" onclick="hideModal()">×</button>
    <h2>claude command</h2>
    <pre>IS_SANDBOX=1 claude --dangerously-skip-permissions \
  --system-prompt {{system_prompt_path}}</pre>
    <p>--dangerously-skip-permissions skips all permission prompts</p>
    <p>--system-prompt loads custom sandbox behavior</p>
    <p>sessions run in tmux and persist across restarts</p>
  </div>
</div>

<script src="/static/main.js"></script>
</body>
</html>
